<div class="trezo-card bg-white dark:bg-[#0c1427] mb-[25px] p-[20px] md:p-[25px] rounded-md"> 
    <div class="trezo-card-header mb-[20px] md:mb-[25px] sm:flex items-center justify-between">
        <div class="trezo-card-title">
            <h5 class="mb-0">Utilisateurs</h5>
        </div>
        <div class="trezo-card-subtitle mt-[10px] sm:mt-0 flex flex-col sm:flex-row items-center gap-3">
            <input type="text" [(ngModel)]="searchText" placeholder="Rechercher un utilisateur..." class="border border-gray-300 dark:border-[#172036] rounded-md px-3 py-2 w-full sm:w-auto dark:bg-[#0c1427] dark:text-white" />
            <button type="button" class="rounded-md inline-block transition-all py-[3.5px] px-[17px] border border-gray-100 dark:border-[#172036] hover:border-primary-500 hover:bg-primary-500 hover:text-white" (click)="openModaladd()">
                <i class="ri-add-line text-xl"></i> Ajouter
            </button>
        </div>
    </div>




<table class="table">
  <thead>
    <tr>
      <th scope="col">Nom</th>
      <th scope="col">Prenom</th>
      <th scope="col">Email</th>
      <th scope="col">Poste</th>
      <th scope="col">Téléphone</th>
      <th scope="col">Adresse</th>
      <th scope="col">CIN</th>
      <th scope="col">Action</th>

    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let u of userData">
      <td>{{u?.nom}}</td>
      <td>{{u?.prenom}}</td>
      <td>{{u?.email}}</td>
      <td>{{u?.poste}}</td>
      <td>{{u?.tel}}</td>
      <td>{{u?.adresse}}</td>
      <td>{{u?.cin}}</td>
      <td class="font-medium text-gray-500 dark:text-gray-400 ltr:text-right rtl:text-left whitespace-nowrap px-[14px] py-[6px] border-b border-gray-100 dark:border-[#172036]">
                            <button class="text-blue-500 hover:text-blue-700" (click)="editUser(u)">
                                <i class="ri-pencil-line"></i> Modifier
                            </button>
                            <button class="text-red-500 hover:text-red-700" (click)="confirmDelete(u)">
                                <i class="ri-delete-bin-line"></i> Supprimer
                            </button>
                        </td>

    </tr>
 
  </tbody>
</table>
  
</div>

<!-- Modal de Modification -->
<div *ngIf="isModalOpen" class="modal-overlay" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h2>Modifier l'utilisateur</h2>
    <form (ngSubmit)="saveUser()">
      <label>Nom:</label>
      <input type="text" [(ngModel)]="selectedUser.nom" name="nom" required />
      
      <label>Prénom:</label>
      <input type="text" [(ngModel)]="selectedUser.prenom" name="prenom" required />
      
      <label>Email:</label>
      <input type="email" [(ngModel)]="selectedUser.email" name="email" required />
      
      <label>Poste:</label>
      <input type="text" [(ngModel)]="selectedUser.poste" name="poste" required />
      
      <label>Téléphone:</label>
      <input type="text" [(ngModel)]="selectedUser.tel" name="tel" required />
      
      <label>Adresse:</label>
      <input type="text" [(ngModel)]="selectedUser.adresse" name="adresse" required />
      
      <label>CIN:</label>
      <input type="text" [(ngModel)]="selectedUser.cin" name="cin" required />
      
      <button type="submit" (click)="update()">Sauvegarder</button>
      <button type="button" (click)="closeModal()">Fermer</button>
    </form>
  </div>
</div>

<!-- Modal de Confirmation de Suppression -->
<div *ngIf="isDeleteConfirmOpen" class="modal-overlay" (click)="cancelDelete()">
    <div class="modal-content bg-white dark:bg-[#0c1427] rounded p-6 w-[90%] md:w-[400px] m-auto mt-[10%]" (click)="$event.stopPropagation()">
      <h2 class="text-lg font-semibold mb-4 text-center text-black dark:text-white">Confirmation</h2>
      <p class="mb-6 text-center text-gray-700 dark:text-gray-300">Êtes-vous sûr de vouloir supprimer cet utilisateur ?</p>
      <div class="flex justify-center gap-4">
        <button class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600" (click)="confirmDeleteUser()">Oui</button>
        <button class="bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400" (click)="cancelDelete()">Non</button>
      </div>
    </div>
</div>

<!-- Modal d'ajout d'un Utilisateur -->
<div *ngIf="showModaladd" class="modal-overlay">
    <div class="modal-content">
      <span class="close" (click)="closeModaladd()">&times;</span>
      <h2>Ajouter un utilisateur</h2>
      <form (ngSubmit)="addUser()">
        <input type="text" [(ngModel)]="newUser.nom" name="nom" placeholder="Nom" required />
        <input type="text" [(ngModel)]="newUser.prenom" name="prenom" placeholder="Prénom" required />
        <input type="email" [(ngModel)]="newUser.email" name="email" placeholder="Email" required />
        <input type="password" [(ngModel)]="newUser.password" name="password" placeholder="Mot de passe" required />
        <input type="text" [(ngModel)]="newUser.adresse" name="adresse" placeholder="Adresse" required />
        <input type="number" [(ngModel)]="newUser.tel" name="tel" placeholder="Tel" required />
        <input type="number" [(ngModel)]="newUser.cin" name="cin" placeholder="CIN" required />
         <select [(ngModel)]="newUser.p" name="p" class="form-control mb-2">
            <option value="CHEF_PROJET">CHEF_PROJET</option>
            <option value="EMPLOYE">EMPLOYE</option>
                        <option value="TECHNICIEN">TECHNICIEN</option>

        </select>
       

        <!-- Liste déroulante pour un autre champ (ex: Actif ou Non) -->
     

        <button type="submit" (click)="saveUser()">Ajouter</button>
        <button (click)="closeModaladd()">Annuler</button>
      </form>
    </div>
</div>
